{"ast":null,"code":"var _jsxFileName = \"/home/carrocinha/Git/Fashionista/src/pages/ProductDetails/ProductDetails.jsx\";\nimport React, { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useSelector, useDispatch } from 'react-redux';\nimport { closeDrawerAction } from \"../../store/actions/drawerActions\";\nimport { getProducts } from \"../../store/actions/productsActions\";\nimport { addProductToCart, updateCartProductQuantity } from \"../../store/actions/cartActions\";\nimport { setProductToBuy, setSizeProductToBuy } from \"../../store/actions/productActions\";\nimport { DEFAULT_PRODUCT_IMAGE } from \"../../utils/constants\";\nimport './ProductDetails.css';\n\nconst ProductDetails = () => {\n  const {\n    products\n  } = useSelector(store => store.productsReducer);\n  const productDetails = useSelector(state => state.productReducer);\n  const {\n    cart\n  } = useSelector(state => state.cartReducer);\n  const product = productDetails.product_info === null ? getProductFromLocalStorage() : productDetails.product_info;\n  const dispatch = useDispatch();\n  const {\n    code_color\n  } = useParams();\n  const [sizeSelected, setSizeSelected] = useState(true);\n  const productSize = product === null ? 'NOT' : product.size || null;\n  useEffect(() => {\n    async function init() {\n      dispatch(closeDrawerAction()); // Fechar o drawer antes de tudo\n\n      if (products.length === 0 || product === null) {\n        var productJSON = localStorage.getItem('@fashionista/product'); // Se a store estiver vazia, faça uma nova requisição\n\n        if (productJSON === null) getProducts(dispatch);\n        dispatch(setProductToBuy(JSON.parse(productJSON))); // convertendo para JSON\n\n        return;\n      }\n\n      let productAux = products.find(product => product.code_color === code_color);\n      dispatch(setProductToBuy(productAux));\n      var productString = JSON.stringify(productAux); //converter para salvar\n\n      localStorage.setItem('@fashionista/product', productString);\n    }\n\n    init();\n  }, [code_color, dispatch, product, products]);\n\n  async function getProductFromLocalStorage() {\n    var productJSON = localStorage.getItem('@fashionista/product');\n\n    if (productJSON === null) {\n      await getProducts(dispatch);\n      productJSON = await products.find(p => p.code_color === code_color);\n      var productString = JSON.stringify(productJSON); //converter para salvar\n\n      localStorage.setItem('@fashionista/product', productString); // armazenar\n    }\n\n    return productJSON;\n  }\n\n  async function handleAddProductToCart() {\n    // adicionar novo campo 'size'\n    await dispatch(setProductToBuy(product));\n    console.log(product);\n\n    if (productSize === null || productSize === 'NOT') {\n      setSizeSelected(false);\n      return;\n    }\n\n    const pAux = cart.find(p => p.product_info.code_color === productDetails.product_info.code_color && p.product_info.size === productDetails.product_info.size);\n    if (pAux) await dispatch(updateCartProductQuantity(pAux.product_info.code_color, pAux.product_info.size, 1));else await dispatch(addProductToCart(productDetails));\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"app__container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"product__details\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"figure\", {\n    className: \"product__details__image\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: product.image || DEFAULT_PRODUCT_IMAGE,\n    alt: \"Produto VESTIDO TRANSPASSE BOW\",\n    title: \"VESTIDO TRANSPASSE BOW\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"product__details__content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"product__details__name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 11\n    }\n  }, product.name), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"product__details__price\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 11\n    }\n  }, product.discount_percentage && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"product__details__price product__details__price--from\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 15\n    }\n  }, product.regular_price), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"product__details__price product__details__price--to\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }\n  }, product.actual_price), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"product__details__price product__details__price--installments\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }\n  }, \" em at\\xE9 \", product.installments)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"product__details__sizes\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"product__details__title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }\n  }, \"Escolha o tamanho:\"), !sizeSelected && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"product__details__warning\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 15\n    }\n  }, \"\\xC9 necess\\xE1rio escolher um tamanho\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"product__details__btnGroup\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 13\n    }\n  }, product.sizes && product.sizes.map((s, index) => /*#__PURE__*/React.createElement(\"button\", {\n    key: index,\n    onClick: () => {\n      dispatch(setSizeProductToBuy(s.size));\n    },\n    className: `${productSize === s.size ? 'onClick' : 'sizeButton'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 19\n    }\n  }, s.size)))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"product__details__actions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"product__details__addToCart\",\n    onClick: () => handleAddProductToCart(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }\n  }, \"Adicionar ao carrinho\")))));\n};\n\nexport default ProductDetails;","map":{"version":3,"sources":["/home/carrocinha/Git/Fashionista/src/pages/ProductDetails/ProductDetails.jsx"],"names":["React","useState","useEffect","useParams","useSelector","useDispatch","closeDrawerAction","getProducts","addProductToCart","updateCartProductQuantity","setProductToBuy","setSizeProductToBuy","DEFAULT_PRODUCT_IMAGE","ProductDetails","products","store","productsReducer","productDetails","state","productReducer","cart","cartReducer","product","product_info","getProductFromLocalStorage","dispatch","code_color","sizeSelected","setSizeSelected","productSize","size","init","length","productJSON","localStorage","getItem","JSON","parse","productAux","find","productString","stringify","setItem","p","handleAddProductToCart","console","log","pAux","image","name","discount_percentage","regular_price","actual_price","installments","sizes","map","s","index"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,SAAT,QAA0B,kBAA1B;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AAEA,SAASC,iBAAT,QAAkC,mCAAlC;AACA,SAASC,WAAT,QAA4B,qCAA5B;AACA,SAASC,gBAAT,EAA2BC,yBAA3B,QAA4D,iCAA5D;AACA,SAASC,eAAT,EAA0BC,mBAA1B,QAAqD,oCAArD;AAEA,SAASC,qBAAT,QAAsC,uBAAtC;AAEA,OAAO,sBAAP;;AAEA,MAAMC,cAAc,GAAG,MAAM;AAE3B,QAAM;AAAEC,IAAAA;AAAF,MAAeV,WAAW,CAACW,KAAK,IAAIA,KAAK,CAACC,eAAhB,CAAhC;AACA,QAAMC,cAAc,GAAGb,WAAW,CAACc,KAAK,IAAIA,KAAK,CAACC,cAAhB,CAAlC;AACA,QAAM;AAAEC,IAAAA;AAAF,MAAWhB,WAAW,CAACc,KAAK,IAAIA,KAAK,CAACG,WAAhB,CAA5B;AAEA,QAAMC,OAAO,GAAGL,cAAc,CAACM,YAAf,KAAgC,IAAhC,GACdC,0BAA0B,EADZ,GAEdP,cAAc,CAACM,YAFjB;AAIA,QAAME,QAAQ,GAAGpB,WAAW,EAA5B;AACA,QAAM;AAAEqB,IAAAA;AAAF,MAAiBvB,SAAS,EAAhC;AAEA,QAAM,CAACwB,YAAD,EAAeC,eAAf,IAAkC3B,QAAQ,CAAC,IAAD,CAAhD;AAEA,QAAM4B,WAAW,GAAGP,OAAO,KAAK,IAAZ,GAAmB,KAAnB,GAA4BA,OAAO,CAACQ,IAAR,IAAgB,IAAhE;AAEA5B,EAAAA,SAAS,CAAC,MAAM;AAEd,mBAAe6B,IAAf,GAAsB;AAEpBN,MAAAA,QAAQ,CAACnB,iBAAiB,EAAlB,CAAR,CAFoB,CAGpB;;AACA,UAAIQ,QAAQ,CAACkB,MAAT,KAAoB,CAApB,IAAyBV,OAAO,KAAK,IAAzC,EAA+C;AAC7C,YAAIW,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,sBAArB,CAAlB,CAD6C,CAG7C;;AACA,YAAIF,WAAW,KAAK,IAApB,EAA0B1B,WAAW,CAACkB,QAAD,CAAX;AAE1BA,QAAAA,QAAQ,CAACf,eAAe,CAAC0B,IAAI,CAACC,KAAL,CAAWJ,WAAX,CAAD,CAAhB,CAAR,CAN6C,CAMO;;AACpD;AACD;;AACD,UAAIK,UAAU,GAAGxB,QAAQ,CAACyB,IAAT,CAAejB,OAAD,IAAaA,OAAO,CAACI,UAAR,KAAuBA,UAAlD,CAAjB;AAEAD,MAAAA,QAAQ,CAACf,eAAe,CAAC4B,UAAD,CAAhB,CAAR;AACA,UAAIE,aAAa,GAAGJ,IAAI,CAACK,SAAL,CAAeH,UAAf,CAApB,CAhBoB,CAgB4B;;AAChDJ,MAAAA,YAAY,CAACQ,OAAb,CAAqB,sBAArB,EAA6CF,aAA7C;AAED;;AACDT,IAAAA,IAAI;AACL,GAvBQ,EAuBN,CAACL,UAAD,EAAaD,QAAb,EAAuBH,OAAvB,EAAgCR,QAAhC,CAvBM,CAAT;;AAyBA,iBAAeU,0BAAf,GAA4C;AAC1C,QAAIS,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,sBAArB,CAAlB;;AAEA,QAAIF,WAAW,KAAK,IAApB,EAA0B;AAExB,YAAM1B,WAAW,CAACkB,QAAD,CAAjB;AAEAQ,MAAAA,WAAW,GAAG,MAAMnB,QAAQ,CAACyB,IAAT,CAAeI,CAAD,IAAOA,CAAC,CAACjB,UAAF,KAAiBA,UAAtC,CAApB;AAEA,UAAIc,aAAa,GAAGJ,IAAI,CAACK,SAAL,CAAeR,WAAf,CAApB,CANwB,CAMyB;;AACjDC,MAAAA,YAAY,CAACQ,OAAb,CAAqB,sBAArB,EAA6CF,aAA7C,EAPwB,CAOqC;AAC9D;;AAED,WAAOP,WAAP;AACD;;AAGD,iBAAeW,sBAAf,GAAwC;AAEtC;AACA,UAAMnB,QAAQ,CAACf,eAAe,CAACY,OAAD,CAAhB,CAAd;AACAuB,IAAAA,OAAO,CAACC,GAAR,CAAYxB,OAAZ;;AAEA,QAAIO,WAAW,KAAK,IAAhB,IAAwBA,WAAW,KAAK,KAA5C,EAAmD;AACjDD,MAAAA,eAAe,CAAC,KAAD,CAAf;AACA;AACD;;AAED,UAAMmB,IAAI,GAAG3B,IAAI,CAACmB,IAAL,CAAUI,CAAC,IACtBA,CAAC,CAACpB,YAAF,CAAeG,UAAf,KAA8BT,cAAc,CAACM,YAAf,CAA4BG,UAA1D,IACAiB,CAAC,CAACpB,YAAF,CAAeO,IAAf,KAAwBb,cAAc,CAACM,YAAf,CAA4BO,IAFzC,CAAb;AAIA,QAAIiB,IAAJ,EACE,MAAMtB,QAAQ,CAAChB,yBAAyB,CAACsC,IAAI,CAACxB,YAAL,CAAkBG,UAAnB,EAA+BqB,IAAI,CAACxB,YAAL,CAAkBO,IAAjD,EAAuD,CAAvD,CAA1B,CAAd,CADF,KAGE,MAAML,QAAQ,CAACjB,gBAAgB,CAACS,cAAD,CAAjB,CAAd;AACH;;AAGD,sBACE;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAQ,IAAA,SAAS,EAAC,yBAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,GAAG,EAAEK,OAAO,CAAC0B,KAAR,IAAiBpC,qBADxB;AAEE,IAAA,GAAG,EAAC,gCAFN;AAGE,IAAA,KAAK,EAAC,wBAHR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,eASE;AAAK,IAAA,SAAS,EAAC,2BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAI,IAAA,SAAS,EAAC,wBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAwCU,OAAO,CAAC2B,IAAhD,CADF,eAGE;AAAK,IAAA,SAAS,EAAC,yBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEI3B,OAAO,CAAC4B,mBAAR,iBACA;AAAM,IAAA,SAAS,EAAC,uDAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAyE5B,OAAO,CAAC6B,aAAjF,CAHJ,eAKE;AAAM,IAAA,SAAS,EAAC,qDAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAuE7B,OAAO,CAAC8B,YAA/E,CALF,eAME;AAAM,IAAA,SAAS,EAAC,+DAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAyF9B,OAAO,CAAC+B,YAAjG,CANF,CAHF,eAYE;AAAK,IAAA,SAAS,EAAC,yBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAG,IAAA,SAAS,EAAC,yBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,EAGI,CAAC1B,YAAD,iBACA;AAAG,IAAA,SAAS,EAAC,2BAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CAJJ,eAME;AAAK,IAAA,SAAS,EAAC,4BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEIL,OAAO,CAACgC,KAAR,IACAhC,OAAO,CAACgC,KAAR,CAAcC,GAAd,CAAkB,CAACC,CAAD,EAAIC,KAAJ,kBAChB;AACE,IAAA,GAAG,EAAEA,KADP;AAEE,IAAA,OAAO,EAAE,MAAM;AAAEhC,MAAAA,QAAQ,CAACd,mBAAmB,CAAC6C,CAAC,CAAC1B,IAAH,CAApB,CAAR;AAAwC,KAF3D;AAGE,IAAA,SAAS,EAAG,GAAED,WAAW,KAAK2B,CAAC,CAAC1B,IAAlB,GAAyB,SAAzB,GAAqC,YAAa,EAHlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAKG0B,CAAC,CAAC1B,IALL,CADF,CAHJ,CANF,CAZF,eAkCE;AAAK,IAAA,SAAS,EAAC,2BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAQ,IAAA,SAAS,EAAC,6BAAlB;AAAgD,IAAA,OAAO,EAAE,MAAMc,sBAAsB,EAArF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BADF,CAlCF,CATF,CADF,CADF;AAsDD,CAvID;;AAwIA,eAAe/B,cAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport { closeDrawerAction } from \"../../store/actions/drawerActions\";\nimport { getProducts } from \"../../store/actions/productsActions\";\nimport { addProductToCart, updateCartProductQuantity } from \"../../store/actions/cartActions\";\nimport { setProductToBuy, setSizeProductToBuy } from \"../../store/actions/productActions\";\n\nimport { DEFAULT_PRODUCT_IMAGE } from \"../../utils/constants\";\n\nimport './ProductDetails.css';\n\nconst ProductDetails = () => {\n\n  const { products } = useSelector(store => store.productsReducer);\n  const productDetails = useSelector(state => state.productReducer);\n  const { cart } = useSelector(state => state.cartReducer);\n\n  const product = productDetails.product_info === null ?\n    getProductFromLocalStorage() :\n    productDetails.product_info;\n\n  const dispatch = useDispatch();\n  const { code_color } = useParams();\n\n  const [sizeSelected, setSizeSelected] = useState(true);\n\n  const productSize = product === null ? 'NOT' : (product.size || null);\n\n  useEffect(() => {\n\n    async function init() {\n\n      dispatch(closeDrawerAction());\n      // Fechar o drawer antes de tudo\n      if (products.length === 0 || product === null) {\n        var productJSON = localStorage.getItem('@fashionista/product');\n\n        // Se a store estiver vazia, faça uma nova requisição\n        if (productJSON === null) getProducts(dispatch);\n\n        dispatch(setProductToBuy(JSON.parse(productJSON))); // convertendo para JSON\n        return;\n      }\n      let productAux = products.find((product) => product.code_color === code_color);\n\n      dispatch(setProductToBuy(productAux));\n      var productString = JSON.stringify(productAux); //converter para salvar\n      localStorage.setItem('@fashionista/product', productString);\n\n    }\n    init();\n  }, [code_color, dispatch, product, products]);\n\n  async function getProductFromLocalStorage() {\n    var productJSON = localStorage.getItem('@fashionista/product');\n\n    if (productJSON === null) {\n\n      await getProducts(dispatch);\n\n      productJSON = await products.find((p) => p.code_color === code_color);\n\n      var productString = JSON.stringify(productJSON); //converter para salvar\n      localStorage.setItem('@fashionista/product', productString); // armazenar\n    }\n\n    return productJSON;\n  }\n\n\n  async function handleAddProductToCart() {\n\n    // adicionar novo campo 'size'\n    await dispatch(setProductToBuy(product));\n    console.log(product)\n\n    if (productSize === null || productSize === 'NOT') {\n      setSizeSelected(false);\n      return;\n    }\n\n    const pAux = cart.find(p =>\n      p.product_info.code_color === productDetails.product_info.code_color &&\n      p.product_info.size === productDetails.product_info.size\n    );\n    if (pAux)\n      await dispatch(updateCartProductQuantity(pAux.product_info.code_color, pAux.product_info.size, 1));\n    else\n      await dispatch(addProductToCart(productDetails));\n  }\n\n\n  return (\n    <div className=\"app__container\">\n      <div className=\"product__details\">\n        <figure className=\"product__details__image\">\n          <img\n            src={product.image || DEFAULT_PRODUCT_IMAGE}\n            alt=\"Produto VESTIDO TRANSPASSE BOW\"\n            title=\"VESTIDO TRANSPASSE BOW\"\n          />\n        </figure>\n\n        <div className=\"product__details__content\">\n          <h3 className=\"product__details__name\">{product.name}</h3>\n\n          <div className=\"product__details__price\">\n            {\n              product.discount_percentage && \n              <span className=\"product__details__price product__details__price--from\">{product.regular_price}</span>\n            }\n            <span className=\"product__details__price product__details__price--to\">{product.actual_price}</span>\n            <span className=\"product__details__price product__details__price--installments\"> em até {product.installments}</span>\n          </div>\n\n          <div className=\"product__details__sizes\">\n            <p className=\"product__details__title\">Escolha o tamanho:</p>\n            {\n              !sizeSelected &&\n              <p className=\"product__details__warning\">É necessário escolher um tamanho</p>\n            }\n            <div className=\"product__details__btnGroup\">\n              {\n                product.sizes &&\n                product.sizes.map((s, index) =>\n                  <button\n                    key={index}\n                    onClick={() => { dispatch(setSizeProductToBuy(s.size)); }}\n                    className={`${productSize === s.size ? 'onClick' : 'sizeButton'}`}\n                  >\n                    {s.size}\n                  </button>\n                )\n              }\n            </div>\n          </div>\n\n          <div className=\"product__details__actions\">\n            <button className=\"product__details__addToCart\" onClick={() => handleAddProductToCart()}>\n              Adicionar ao carrinho\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\nexport default ProductDetails;\n\n"]},"metadata":{},"sourceType":"module"}